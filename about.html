<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./css/reset.css" />
    <link rel="stylesheet" href="./css/demo-style.css" />
    <link rel="stylesheet" href="./css/tomorrow-night.css" />
    <title>signalFirebaseとは何か</title>
  </head>
  <body>
    <header>
      <a href="./index.html">
      <div>signalFirebase</div>
    </a>
    </header>
    <main>
      <h1>signalFirebaseとは何か？</h1>
      <p>
        以下の行を1行足すだけで、<br />簡単にFirebase Realtime
        Databaseを扱うことができるライブラリーです
      </p>
      <pre
        class="prettyprint"
        style="text-align: center;"
      ><code>import { sg } from "../js/signalFirebase.js";</code></pre>
      <p>
        Githubに上がっている<a
          href="https://github.com/kyok01/signalFirebase/tree/v1.0.1-dev"
          >version1.01</a
        >をダウンロードして利用可能です（但しMIT license）
      </p>
      <h2>具体的にどんなことができるか？</h2>
      <div id="summary">
        <p>
          例えば、いいね機能がついているチャットアプリやSNSアプリで、いいね順が多い投稿のランキングを表示するとしましょう。<br />通常は以下のようなコーディングをしなければなりません。
        </p>
        <pre class="prettyprint"><code>sortChildLineupWithNum: async function (
    value,
    initFunc,
    mainFunc,
    order = "desc",
    tiedRankBool = true,
    onLoadBool = true,
    RealTimeBool = true
  ) {
    if (onLoadBool == false && RealTimeBool == false) {
      alert("error");
    } else {
      const sortRef = query(this.path, orderByChild(value)); //make value ascending reference
      onValue(sortRef, (snapshot) => {
        if (onLoadBool) {
          initFunc(snapshot);
          const size = snapshot.size;
          let eleNum = 0;
          let rankArr = [];
          snapshot.forEach((childSnapshot) => {
            eleNum++;
            let tempHash = {};
            let tempArr = [];
            for (const [tempKey, tempValue] of Object.entries(
              childSnapshot.val()
            )) {
              tempHash[tempKey] = tempValue;
            }
            tempArr[0] = childSnapshot.key;
            tempArr[1] = tempHash;
            if (order == "desc") {
              rankArr.unshift(tempArr); //move from asc to desc
            }
            if (order == "asc") {
              rankArr.push(tempArr); //keep desc
            }
            if (eleNum == size) {
              let preNum; //former element value
              let rankNum = 0; //ranking number
              rankArr.forEach((ele) => {
                const childKey = ele[0];
                const childValue = ele[1];
                if (tiedRankBool) {
                  if (preNum != childValue[value]) {
                    rankNum++;
                  }
                } else {
                  rankNum++;
                }
                preNum = childValue[value];
                mainFunc(childKey, childValue, rankNum);
              });
            }
          });
          return this;
        }
      });
      await wait(1); //not good coding way
      if (onLoadBool == false && RealTimeBool == true) {
        onLoadBool = true;
      }
      if (onLoadBool == true && RealTimeBool == false) {
        onLoadBool = false;
      }
    }
  }
      </code></pre>
        <p>なんと、60行以上にも渡るようなコードが必要になりましたね。</p>
        <p>
          Firebaseのquery関数やorderByChild関数、onValue関数が必要な上に、<br />場合によっては非同期処理も組み込む必要があります。
        </p>
        <h3>複雑な処理をたったの2行で！</h3>
        <p>
          このような複雑な処理を、ざっくり言えば<span class="marker"
            >import文含めてたったの2行</span
          >で実現できてしまうのがsignalFirebaseライブラリです。
        </p>
        <pre
          class="prettyprint"
        ><code>import { sg } from "../js/signalFirebase.js";<br>sg("chat").sortChildLineupWithNum("good", initFunc, mainFunc);</code></pre>
      </div>
      <h2>何を解決したいプロジェクトなのか？</h2>
      <div class="discription">
        <p>解決したい課題は以下の3つです</p>
        <ul>
          <li>
            ・Firebase ウェブのバージョンが2021年9月に変わったばかりで、日本語の情報が少ない
          <li>
            ・挙動が分かりづらい関数を複数組み合わせないと高度な処理を実現するのが難しい
          </li>
          <li>
            ・Realtime DataBaseの名前の通り、リアルタイムでデータが反映されるので、実装しにくい機能もある
          </li>
        </ul>
        <p>これらの課題に対し、<br>行数が少なくて<span class="marker">学びやすいライブラリ</span>を<br>簡単にPDCAを回せる<span class="marker">デモ付き</span>で提供することで解決に導きます</p>
        <p>"signal"との名前の通り、<br>制御タイミング等の簡単な信号をFirebaseに対して送っているようなイメージで学んでみてください</p>
      </div>
      <h2>ライブラリのデモ</h2>
      <div class="discription">
        <p>名前と年齢、挨拶のデータが5名分入ったRealtime DataBaseの基、<br>3種類のデモを用意しています</p>
        <ul>
          <li>
            ・mappingメソッドを用いて、HTML上にRealtime Databaseを表示させるデモ
          </li>
          <li>
            ・oCADisplayメソッドで通常のonChildAddedよりも詳細にタイミングを制御する
          </li>
          <li>
            ・sortChildLineupWithNumメソッドでカスタマイズされたランキング表を表示する
          </li>
        </ul>
      </div>
      <div id="demos">
        <div class="demos__card" id="demos__card1">
          <a href="./example/mapping-demo.html">
            <div>mapping Demo</div>
          </a>
        </div>
        <div class="demos__card" id="demos__card2">
          <a href="./example/oCADisplay-demo.html">
            <div>oCADisplay Demo</div>
          </a>
        </div>
        <div class="demos__card" id="demos__card3">
          <a href="./example/sortChildLineupWithNum-demo.html">
            <div>sCLWN Demo</div>
          </a>
        </div>
      </div>
    </main>
    <footer>
      <div>Copyright (c) 2022 Kazutaka.Yokoi</div>
      <div>Released under the MIT license</div>
      <div>
        <a href="https://opensource.org/licenses/MIT"
          >https://opensource.org/licenses/MIT</a
        >
      </div>
    </footer>
    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- JQuery -->

    <!--** 以下Firebase **-->    
  </body>
</html>
